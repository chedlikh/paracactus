<!-- panier.component.html -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 py-8 sm:py-12">
  <!-- Breadcrumb mobile-friendly -->
  <div class="flex items-center gap-3 text-sm mb-6 sm:mb-8 animate-slide-in-left text-emerald-600">
    <a routerLink="/" class="font-medium flex items-center gap-2 hover:text-emerald-700">
      <i class="fas fa-home"></i> Accueil
    </a>
    <i class="fas fa-chevron-right text-emerald-300"></i>
    <span class="text-gray-700 font-semibold">Mon Panier</span>
  </div>

  <div class="grid lg:grid-cols-3 gap-6 lg:gap-8">
    <!-- Liste des articles -->
    <div class="lg:col-span-2 space-y-6">
      <div class="animate-slide-in-left">
        <h1 class="text-4xl sm:text-5xl font-bold text-gradient mb-3 flex items-center gap-3 sm:gap-4">
          <span class="text-5xl sm:text-6xl animate-float">ðŸ›’</span> Mon Panier
        </h1>
        <p class="text-gray-600 text-base sm:text-lg">{{ cartItems().length }} article{{ cartItems().length > 1 ? 's' : '' }}</p>
      </div>

      <div class="space-y-5">
        <div *ngFor="let item of cartItems(); let i = index" 
             class="glass-effect rounded-3xl p-5 sm:p-6 hover-lift card-shine shadow-xl animate-slide-in-left"
             [style.animation-delay.ms]="i * 100">
          <div class="flex flex-col sm:flex-row gap-4 sm:gap-6">
            <div class="relative flex-shrink-0">
              <div class="w-28 h-28 sm:w-32 sm:h-32 rounded-2xl overflow-hidden bg-gradient-to-br from-emerald-100 to-green-100 shadow-lg">
                <img [src]="item.image" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-500">
              </div>
              <div *ngIf="item.badge" class="absolute -top-2 -right-2 sm:-top-3 sm:-right-3 bg-gradient-to-r {{item.badgeColor}} text-white px-3 py-1 rounded-full text-xs font-bold shadow-lg animate-pulse">
                {{item.badge}}
              </div>
            </div>

            <div class="flex-1">
              <div class="flex justify-between items-start mb-2">
                <div>
                  <span class="text-emerald-600 text-xs font-bold uppercase tracking-wider">{{item.category}}</span>
                  <h3 class="text-lg sm:text-xl font-bold text-gray-800 mt-1 line-clamp-2">{{item.name}}</h3>
                </div>
                <button (click)="removeItem(item.id)" class="text-rose-500 hover:text-rose-600 hover:rotate-90 transition-all text-xl">
                  <i class="fas fa-trash"></i>
                </button>
              </div>

              <div class="flex items-center gap-3 text-sm mb-4">
                <span class="text-emerald-600 flex items-center gap-1"><i class="fas fa-check-circle"></i> En stock</span>
                <span class="text-yellow-500">â˜…â˜…â˜…â˜…â˜…</span>
              </div>

              <div class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4">
                <div class="flex items-center gap-2 bg-emerald-50 rounded-2xl p-1 border-2 border-emerald-200 w-full sm:w-auto">
                  <button (click)="updateQuantity(item, -1)" class="w-10 h-10 rounded-xl bg-white hover:bg-emerald-500 hover:text-white transition-all flex items-center justify-center text-lg font-bold shadow-md">
                    <i class="fas fa-minus"></i>
                  </button>
                  <input type="number" [(ngModel)]="item.quantity" (change)="updateQuantity(item, 0)" 
                         class="w-16 text-center font-bold text-xl bg-transparent border-none focus:outline-none">
                  <button (click)="updateQuantity(item, 1)" class="w-10 h-10 rounded-xl bg-white hover:bg-emerald-500 hover:text-white transition-all flex items-center justify-center text-lg font-bold shadow-md">
                    <i class="fas fa-plus"></i>
                  </button>
                </div>

                <div class="text-right">
                  <div class="text-2xl sm:text-3xl font-bold text-gradient">{{ (item.price * item.quantity).toFixed(2) }} DT</div>
                  <div *ngIf="item.oldPrice" class="text-sm text-gray-400 line-through">{{ (item.oldPrice * item.quantity).toFixed(2) }} DT</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- RÃ©sumÃ© (sticky sur desktop, normal sur mobile) -->
    <div class="lg:col-span-1">
      <div class="glass-effect rounded-3xl p-6 sm:p-8 sticky top-24 animate-slide-in-right shadow-2xl border-2 border-emerald-200">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-2xl font-bold text-gradient">RÃ©sumÃ©</h2>
          <span class="text-5xl animate-float">ðŸŒµ</span>
        </div>

        <div *ngIf="savings() > 0" class="bg-gradient-to-r from-emerald-500 to-green-500 text-white rounded-2xl p-4 mb-6 text-center shadow-lg animate-pulse-glow">
          <div class="flex items-center justify-center gap-2 font-bold">
            <i class="fas fa-tag"></i>
            <span>Ã‰conomies : {{ savings().toFixed(2) }} DT</span>
          </div>
        </div>

        <div class="space-y-4 mb-6 text-sm sm:text-base">
          <div class="flex justify-between"><span>Sous-total ({{ cartItems().length }} article{{ cartItems().length > 1 ? 's' : '' }})</span><span class="font-bold">{{ subtotal().toFixed(2) }} DT</span></div>
          <div class="flex justify-between"><span>Livraison</span><span class="text-emerald-600 font-bold flex items-center gap-2"><i class="fas fa-truck"></i> GRATUIT</span></div>
          <div *ngIf="discount() > 0" class="flex justify-between text-rose-600 font-bold"><span>RÃ©duction</span><span>-{{ discount().toFixed(2) }} DT</span></div>
          <div class="h-px bg-gradient-to-r from-transparent via-emerald-300 to-transparent my-4"></div>
          <div class="flex justify-between text-lg sm:text-xl"><span class="font-bold">Total TTC</span><span class="text-2xl sm:text-3xl font-bold text-gradient">{{ total().toFixed(2) }} DT</span></div>
        </div>

        <div class="bg-gradient-to-br from-emerald-50 to-green-50 rounded-2xl p-4 mb-6 border-2 border-emerald-200">
          <div class="flex flex-col sm:flex-row gap-3">
            <input type="text" [(ngModel)]="promoCode" placeholder="Code promo (ex: CACTUS10)" class="flex-1 px-4 py-3 rounded-xl border-2 border-emerald-200 focus:border-emerald-400 transition-all text-sm">
            <button (click)="applyPromo()" class="px-6 py-3 bg-gradient-to-r from-emerald-500 to-green-500 text-white rounded-xl font-bold hover:scale-105 btn-glow text-sm">Appliquer</button>
          </div>
        </div>

        <button class="w-full py-5 bg-gradient-to-r from-emerald-500 via-green-500 to-teal-500 text-white rounded-2xl font-bold text-base sm:text-lg shadow-2xl hover:scale-105 btn-glow flex items-center justify-center gap-3">
          <i class="fas fa-lock"></i> Paiement SÃ©curisÃ©
        </button>

        <button routerLink="/" class="w-full mt-4 py-4 border-2 border-emerald-500 text-emerald-600 rounded-2xl font-bold hover:bg-emerald-50 transition-all flex items-center justify-center gap-2 text-sm">
          <i class="fas fa-arrow-left"></i> Continuer mes achats
        </button>
      </div>
    </div>
  </div>
</div>

<style>
  @keyframes fall { to { transform: translateY(110vh) rotate(720deg); opacity: 0; } }
</style>